% -----------------------------------------------------------------
% 			  Introduction
% -----------------------------------------------------------------
\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=\textbf{Numerical Optimization}]
{\bf {\sc Newton} Root-finding problem}
\begin{flalign*}
R:\mathbb{R}^n\rightarrow \mathbb{R}^n
\end{flalign*}
Root-finding series:
\begin{flalign*}
z_{k+1}=z_k - (\nabla_z R(z_k))^{-1}\cdot R(z_k)
\end{flalign*}
\hfill $\nabla f(x) := \frac{\partial f}{\partial x}(x)^\top$\\
General {\sc Newton} type method (NT-method):
\begin{flalign*}
z_{k+1}=z_k - M_k^{-1}\cdot R(z_k)\ |\ M_k\approx \nabla_z R(z_k)
\end{flalign*}
{\bf Local-contraction theorem} for \textsc{Newton} type iterations:
\begin{flalign*}
  \norm{z_{k+1}-z^*}\le
  \left(
    \kappa_k+\frac{\omega}{2}\norm{z_k-z^*}
  \right)\norm{z_k-z^*}\end{flalign*}
  \begin{flalign*}
  \mathrm{if}\ \exists \omega < \infty, \kappa <1\ \mathrm{such\ that}\\
  \norm{M_k^{-1}(\nabla_z R(z_k)-\nabla_z R(z)} \le \omega \norm{z_k -z}\ 
  (\textsc{Lipschitz}\mathrm{-condition})\\
  \norm{M_k^{-1}(\nabla_z R(z_k) - M_k)} \le  \kappa_k \le \kappa\
  (\mathrm{compatibility\ condition})\\
  \mathrm{and}\ \norm{z_0-z^*}<\frac{2(1-\kappa)}{\omega}
\end{flalign*}
Notes:
\begin{itemize}
\item $R(z^*)=0$
\item $\kappa=0$ for exact \textsc{Newton}
\end{itemize}
\textbf{Affine Invariance}: Affine Coordinate changes do not affect the optimal
solution $z^*$ of $R(z)$
\begin{align*}
  R(z)\stackrel{!}{=}0 &\stackrel{\mathrm{NT}}{\rightarrow} z_0, z_1, ... \\
  \Leftrightarrow \tilde{R}(y):=A\cdot R(b+By)
  &\stackrel{\mathrm{NT}}{\rightarrow} y_0=B^{-1}(z_0-b),y_1, ...
\end{align*}

\tcblower

\textbf{Tight condition for local convergence}
\begin{flalign*}
  \ti{\kappa}{exact}=\rho \left(M(z^*)\inv \left(M(z^*) - \nabla_z R(z^*)\right)\right)
  \left\{
  \begin{array}{cl}
    < 1: &\mathrm{converges\ to\ }z^* \\
    > 1: &\mathrm{diverges}
  \end{array}
  \right.
\end{flalign*}
\begin{itemize}
\item Arugment in $\rho$: Difference of approximate of Jacobian at $z^*$
\item \textbf{``spectral radius''} $\rho(A):=\max (|\lambda|\in \mathrm{eig}(A))$
\end{itemize}
\end{tcolorbox}

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=\textbf{Nonlinear
    Optimization (NLP)}]
  \textbf{Problem:}

    \begin{empheq}[box=\fbox]{align*}
        \min_w &\ f(w) \\
        \mathrm{s.t.} &\ g(w)=0 \\
        &\ h(w) \le 0
    \end{empheq}
    \begin{itemize}
    \item Feasible set: $\Omega:= \{w\in\mathbb{R}^n|g(w)=0, h(w)\le 0\}$
    \item Active set at $w\in \Omega$: index $i$ is \emph{active} at $w\Leftrightarrow
    h_i(w)=0$
  \end{itemize}
  \textsc{LaGrangian}
  \begin{flalign*}
    \mathcal{L}(w,\lambda, \mu) = f(w) + \lambda^\top g(w) + \mu^\top h(w) \\
    \mathcal{A}(w^*):=\{i|i=1,2,...,n_h; \lambda^*_i \ne 0\}\ \mathrm{(``Active\ Set"')}
  \end{flalign*}
  \textbf{1. KKT cond.} %TODO: 2nd KKT
  \begin{flalign*}
    \nabla_w\mathcal{L}(w^*,\lambda^*,\mu^*)=0
  \end{flalign*}
  % \textbf{2. KKT cond.}
  Remarks:
  \begin{itemize}
  \item $\nabla_w\mathcal{L}(w^*,\lambda^*)$ for equality constr. only
  \item $\mu_i\ge 0 \Leftrightarrow$ ``Can't push downhill''
  \end{itemize}
  \textbf{Complementary conditions}
  \begin{flalign*}
    \left.
    \begin{array}{r}
    h_i(w^*) \le 0 \\
    \mu_i^* \ge 0 \\
    \mu_ih_i(w^*) = 0
    \end{array}      
    \right\}\mathrm{NOT\ differentiable!}
  \end{flalign*}
  \textbf{Second order optimality conditions}\\
  \begin{itemize}
  \item[\textbf{SONC}] $w^*$ local min $\Rightarrow Z^\top
    \nabla_w^2\mathcal{L}(w^*,\lambda^*, \mu^*)Z
    \succcurlyeq 0$
    % TODO: Maybe decide whether to mention the reduced hessian?
  \item[\textbf{SOSC}] $w^*$ local min $\Leftarrow Z^\top
    \nabla_w^2\mathcal{L}(w^*,\lambda^*, \mu^*)Z\succ 0$
  \item[with] $Z^\top Z=I, \frac{\partial \tilde{g}}{\partial w}(w^*)Z=0$
  \end{itemize}
  \begin{flalign*}
    \tilde{g}(w)=
    \left[
      \begin{array}{c}
        g(w) \\ h_i(w^*), i\in \mathcal{A}(w^*)
      \end{array}
    \right]
  \end{flalign*}
\end{tcolorbox}

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=\textsc{Newton}\textbf{-type
    optimal algorithms}]
  $\rightarrow$ only equality-conditions
  \begin{flalign*}
    \left[
      \begin{array}{c}
        w_{k+1} \\ \lambda_{k+1}
      \end{array}
    \right]
    =
    \left[
      \begin{array}{c}
        w_k \\ 0
      \end{array}
    \right]
    -
    \underbrace{
    \left[
      \begin{array}{cc}
        B_k & \nabla_w g(w_k) \\
        \nabla_w g(w_k)^\top & 0\\
      \end{array}^{-1}
    \right]}_\text{inverse\ KKT-Matrix}
\end{flalign*}
Exact \textsc{Newton}: $\nabla_w^2\mathcal{L}(w_k,\lambda_k)$, else: approximate it!
\end{tcolorbox}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../HelpSheet"
%%% End:
